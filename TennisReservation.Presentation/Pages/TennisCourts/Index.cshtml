@page
@using TennisReservation.Domain.Models
@using TennisReservation.Presentation.Pages.TennisCourts
@model TennisReservation.Presentation.Pages.TennisCourts.IndexModel
@{
    ViewData["Title"] = "Теннисные корты";
}

<div class="container mt-4">
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>🎾 Теннисные корты</h1>
        <div>
            <a asp-page="/Index" class="btn btn-outline-secondary me-2">
                <i class="fas fa-home me-1"></i> На главную
            </a>
            <a asp-page="Create" class="btn btn-success">
                <i class="fas fa-plus me-1"></i> Добавить корт
            </a>
        </div>
    </div>

    <div class="row">
        @foreach (var court in Model.TennisCourts)
        {
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">@court.Name
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <h6 class="text-muted">Почасовая ставка:</h6>
                            <h4 class="text-success">@court.HourlyRate.ToString("N0") ₽/час</h4>
                        </div>

                        <div class="mb-3">
                            <h6 class="text-muted">Описание:</h6>
                            <p class="card-text">@court.Description</p>
                        </div>

                        <div class="d-flex justify-content-between mt-auto">
                            <a asp-page="./Edit" asp-route-id="@court.Id" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-edit me-1"></i> Редактировать
                            </a>
                            <button class="btn btn-sm btn-outline-danger"
                                    data-bs-toggle="modal"
                                    data-bs-target="#deleteModal-@court.Id">
                                <i class="fas fa-trash me-2"></i>Удалить
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal fade"
                     id="deleteModal-@court.Id"
                     data-bs-backdrop="static"
                     data-bs-keyboard="false"
                     tabindex="-1">
                     <div class="modal-dialog">
                         <div class="modal-content">

                             <div class="modal-header">
                                 <h5>Подтверждение удаления</h5>
                                 <button class="btn-close" data-bs-dismiss="modal">
                                 </button>
                             </div>

                             <div class="modal-body">
                                 <p>Вы действительно хотите удалить @court.Name?</p>
                                 <p class="text-danger">Это действие нельзя отменить</p>
                             </div>

                             <div class="modal-footer">
                                 <button class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                                 <form method="post" asp-page-handler="Delete" asp-route-id="@court.Id"> 
                                     <button class="btn btn-danger">
                                         <i class="fas fa-trash me-1"></i> Удалить
                                     </button>
                                 </form>
                             </div>
                         </div>
                     </div>>
                </div>
            </div>
        }
    </div>

    @if (!Model.TennisCourts.Any())
    {
        <div class="card shadow-sm">
            <div class="card-body text-center py-5">
                <h5 class="text-muted">Корты не найдены</h5>
                <a asp-page="Create" class="btn btn-success mt-2">
                    <i class="fas fa-plus me-1"></i> Добавить первый корт
                </a>
            </div>
        </div>
    }
</div>